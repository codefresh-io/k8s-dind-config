---
apiVersion: v1
kind: Pod
metadata:
  name: k8s-dind-config
  annotations:
    forceRedeployUniqId: "N/A"
  labels:
    app: dind
spec:
  containers:
  - image: codefresh/k8s-dind-config:master
    name: k8s-dind-config
    imagePullPolicy: Allways
    lifecycle:
      postStart:
        exec:
          command:
            - "/bin/bash"
            - "-c"
            - |
              echo "192.168.99.100  codefresh.dev" >> /etc/hosts
    command:
      - "/app/k8s-dind-config"
#          - "/bin/bash"
#          - "-c"
#          - |
#            while true
#            do
#              date; sleep 60
#            done
    env:
      - name: NAMESPACE
        valueFrom:
          fieldRef:
            fieldPath: metadata.namespace
      - name: API_HOST
        value: "http://codefresh.dev"
      - name: SIGN_API_PATH
        value: "api/pki/signServerCerts"
      - name: TOKEN
        value: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJfaWQiOiI1OWM1ZTA3ZjJiM2I0ZTIwYjMwM2NhNzEiLCJhY2NvdW50SWQiOiI1OWM1ZTA3ZjJiM2I0ZTIwYjMwM2NhNzIiLCJpYXQiOjE1MDYyNjE1NjIsImV4cCI6MTUwODg1MzU2Mn0.fpMNtEiNS1B37yFmI3yup7VtQe55EJHPQOrlWUa2ImU"
